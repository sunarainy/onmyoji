    请不要传播！
    请不要传播！
    请不要传播！
    
#### Build 20210531
    修改：将START按钮与STOP合并
          适配新结算界面
          修改图片匹配的模式
    新增：自定义开始按钮位置
#### Build 20201024
    修改：自动检测缩放比例，去除填写表单

#### Build 20200226
    增加：预定结束模式增加超鬼王检测，发现鬼王停止挂机并播放音乐
    增加：Ctrl + F2 进入debug模式，记录日志

#### Build 20200125
    增加：自动点击御魂满仓提示

#### Build 20190423
    增加：快捷键 Ctrl + F1 停止挂机
    
#### Build 20190421
    修改：使用战斗数据按钮作为战斗结束标志，修复因为掉落过多遮挡背景导致结算结束判定不准的问题
    修改：修复不能关闭游戏的问题

#### Build 20180405
    增加了乘客是否进入战斗的判定
    增加了预定结束后指定操作

#### Build 20180221  
    增加了好友发来悬赏的处理机制
    程序运行时不再检测游戏是否运行，改为点击START按钮时检测

#### Build 20180220
    修复了预定结束一定要使用的bug

#### Build 20180219
    增加了定时/定场预定结束挂机的功能
    优化了坐标计算方式
    隐藏了console窗口
   
   
![界面截图](https://raw.githubusercontent.com/sunarainy/onmyoji/master/image/capture.png)

FAQ
====

## 1. 如何运行程序？为什么点了START按钮没有反应？

本程序仅适用于桌面版客户端。

* 第一种方式：Python直接运行 

使用`'管理员'`身份启动cmd，再执行:
```text
python onmyoji_win.py
```

* 第二种方式：打包为exe后运行

首先安装pyinstaller，然后在cmd中执行：
```text
pyinstaller onmyoji_win.spec
```
在生成的dist目录中，找到onmyoji_win.exe，使用`'管理员'`身份启动。

注意要赋给console或exe管理员权限，否则程序无法移动鼠标。

## 2. 在什么情况下可以使用？

使用范围：

* 八歧大蛇
* 觉醒麒麟
* 业（丛）原火
* 御灵

其中，八歧大蛇和觉醒是可以组队的，可以使用'乘客'或'司机'模式，业（丛）原火和御灵只用'单刷'模式就好。

根据每个副本的实际情况，设置一个合理的平均通关时间，可以节省一些CPU占用。
如果不知道要设置多少，宁愿把数字设置的小一点，也不要过大，否则可能会在结算界面停留很久（因为程序会强制等待你所填入的时间）。

## 3. 在游戏什么界面下点START？

在'模式'下拉框右边有一个'?'按钮，通过切换不同的模式，点击该按钮获得使用说明。

## 4. 程序运行后，生成了3个文件，这些是什么，能删除吗？

程序运行后，会生成3个文件，mysetting.db.bak mysetting.db.dat mysetting.db.dir
这是用来保存上一次运行所使用的缩放倍率和平均通关时间的文件。如果删除，程序也可运行，不过设置会变成默认值。然后再生成这三个文件。

## 5. 使用预定结束功能能自动关闭buff吗？
目前自动关闭buff的功能还没有添加，现在的处理方式是达到预定目标后，即关闭游戏窗口。关闭游戏窗口（下线）后，15分钟后游戏后台会自动关闭buff。
如果可以及时在手机端登录，buff是马上关闭的。可以配合闹钟等手段减少buff时间的损失。

## 6. 其他注意事项

点击START后，请`不要移动游戏窗口或调整窗口大小`，因为此后的过程是以点击START按钮时窗口状态为准计算的。

缩放倍率大于1的，尽量`把游戏窗口摆在左上角`,因为Pillow库在截图时，不会以系统实际倍率去截图，靠近左上角不容易越过截图边界。

挂机过程中，请`不要遮盖游戏画面左上角`，左上角是战斗是否结束的判定区域，所以，不能使用游戏内的聊天功能。

自定义超鬼王提醒声音：在程序同目录下放一个名为`fuckboss.mp3`的文件即可。
